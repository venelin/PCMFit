<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Maximum likelihood fit and selection of phylogenetic comparative models • PCMFit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Maximum likelihood fit and selection of phylogenetic comparative models">
<meta property="og:description" content="PCMFit provides maximum likelihood inference and 
  selection of phylogenetic comparative models (PCMs). Currently, the package 
  implements Gaussian and mixed Gaussian phylogenetic models (MGPMs) over all 
  tree types (including non-ultrametric and polytomic trees). The package 
  supports non-existing traits or missing measurements for some of the traits on 
  some of the species. The package supports specifying measurement error 
  associated with each tip of the tree or inferring a measurement error 
  parameter for a group of tips. The Gaussian phylogenetic models include 
  various parametrizations of Brownian motion (BM) and Ornstein-Uhlenbeck (OU) 
  multivariate branching processes. The mixed Gaussian models represent models 
  with shifts in the model parameters as well as the type of model at points of 
  the tree. Each shift-point is described as a pair of a shift-node and 
  associated type of model (e.g. OU or BM) driving the trait evolution from the 
  beginning of the branch leading to the shift-node toward the shift-node and 
  its descendants until reaching a tip or another shift-point. The function 
  PCMFit is used to fit a given PCM or a MGPM for a given tree with specified 
  shift-points. The function PCMFitMixed is used to fit an ensemble of possible 
  MGPMs over a tree for which the shift-points are unknown. This function can 
  perform approximage model selection of the best MGPM for a given tree and data 
  according to an information loss function such as the Akaike information 
  criterion (AIC) and a heuristic-based recursive clade partition search 
  algorithm. The package version 1.0.0 has been used in the research article 
  Mitov et al. 2019 &lt;doi:10.1073/pnas.1813823116&gt;. Currently, the package is 
  available from &lt;https://github.com/venelin/PCMFit&gt;. The web-page 
  &lt;https://venelin.github.io/PCMFit/&gt; provides access to documentation and 
  related resources.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129563006-6"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129563006-6');
</script>
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">PCMFit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/pcmfit.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/pcmfitmixed.html">Inferring an MGPM with Unknown Shifts</a>
    </li>
    <li>
      <a href="articles/parambootstrap.html">Parametric Bootstrap</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="page-header"><h1>

PCMFit: Statistical inference of phylogenetic comparative models

</h1></div>
<p>The goal of PCMFit is to provide a generic tool for inference and selection of phylogenetic comparative models (PCMs). Currently, the package implements Gaussian and mixed Gaussian phylogenetic models (MGPM) over all tree types (including non-ultrametric and polytomic trees). The package supports non-existing traits or missing measurements for some of the traits on some of the species. The package supports specifying measurement error associated with each tip of the tree or inferring a measurement error parameter for a group of tips. The Gaussian phylogenetic models include various parametrizations of Brownian motion (BM) and Ornstein-Uhlenbeck (OU) multivariate branching processes. The mixed Gaussian models represent models with shifts in the model parameters as well as the type of model at points of the tree. Each shift-point is described as a pair of a shift-node and associated type of model (e.g. OU or BM) driving the trait evolution from the beginning of the branch leading to the shift-node toward the shift-node and its descendants until reaching a tip or another shift-point. The function PCMFit is used to fit a given PCM or a MGPM for a given tree with specified shift-points. The function PCMFitMixed is used to fit an ensemble of possible MGPMs over a tree for which the shift-points are unknown. This function can perform model selection of the best MGPM for a given tree and data according to an information loss function such as the Akaike information criterion (AIC). The package has been thoroughly tested and applied to real data in the related research article (Mitov, Bartoszek, and Stadler 2019) <a href="doi:10.1073/pnas.1813823116" class="uri">doi:10.1073/pnas.1813823116</a>. Currently, the package is available from <a href="https://github.com/venelin/PCMFit" class="uri">https://github.com/venelin/PCMFit</a>. The web-page <a href="https://venelin.github.io/PCMFit/" class="uri">https://venelin.github.io/PCMFit/</a> provides access to documentation and related resources.</p>
<!--An early version of this article is available in Chapter 7 of the doctoral thesis available at <https://doi.org/10.3929/ethz-b-000315296>. -->
<div id="prerequisites" class="section level1">
<h1 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h1>
<p>Before installing PCMFit, it is necessary to ensure that several R-packages are installed or can be installed from CRAN. These are listed below:</p>
<ul>
<li>
<a href="https://venelin.github.io/PCMBase">PCMBase</a>. The PCMBase package is available on CRAN and should be installed automatically during the installation of PCMFit. If this does not happen, try the command:</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"PCMBase"</span>)</span></code></pre></div>
<ul>
<li>
<p>[<a href="https://github.com/venelin/PCMBaseCpp">PCMBaseCpp</a>]. This package contains Rcpp modules for likelihood calculation of the model types implemented in PCMBase. PCMBaseCpp can be used as a companion and not a substitute of PCMBase. The sole purpose of PCMBaseCpp is to accelerate the likelihood calculation by implementing the most computationally intensive algorithm in C++, which has shown a dramatic speed-up (in the order of 100 times) (Mitov et al. 2018). Hence, installing this package is optional but highly recommended, in particular, if the goal is to infer models with shifts and/or to infer models on trees bigger than 100 tips. Installing PCMBaseCpp requires a C++ compiler to be installed on the system. This installation has been tested on two systems:</p>
<ul>
<li>On Mac OS X, it has been tested using the default (clang) and the Intel (icpc) compiler.</li>
<li>On Linux (Euler ETH cluster), it has been tested with the following modules loaded (commands in the file <code>.bashrc</code>):</li>
</ul>
</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">module</span> load interconnect/ethernet</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ex">module</span> load new gcc/6.3.0 open_mpi/1.6.5 r/3.4.0 intel/2017.5</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">xcode-select</span> --install</span></code></pre></div>
<p>Upon validating the availability of a C++ compiler, PCMBaseCpp can be installed using the commands:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># These two packages are available on CRAN</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"Rcpp"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"RcppArmadillo"</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># At the time of writing, PCMBaseCpp is available only from github. </span></span>
<span id="cb4-5"><a href="#cb4-5"></a>devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"venelin/PCMBaseCpp"</span>)</span></code></pre></div>
<ul>
<li><p>other third party dependencies include the packages <a href="https://CRAN.R-project.org/package=data.table"><code>data.table</code></a>, <a href="https://CRAN.R-project.org/package=foreach"><code>foreach</code></a>, <a href="https://CRAN.R-project.org/package=iterators"><code>iterators</code></a>, <a href="https://CRAN.R-project.org/package=ape"><code>ape</code></a> and <a href="https://CRAN.R-project.org/package=digest"><code>digest</code></a>. These packages should be installed automatically from CRAN when installing PCMFit. If this does not happen, consult the packages’ web-pages (links above).</p></li>
<li><p>An optional but highly recommended dependency. The function <code>PCMTreePlot</code> in the package PCMBase uses the R-package ggtree, which is not on CRAN. It is highly recommended to install this package in order to be able to visualize trees with colored parts corresponding to defferent evolutionary regimes. If <code>ggtree</code> is not installed, the figures in the vignettes and coding examples cannot be generated. At the time of writing this documentation, <code>ggtree</code> can be installed from bioconductor through the following code (if that does not work, check the <a href="https://guangchuangyu.github.io/software/ggtree/">ggtree home page</a>):</p></li>
</ul>
<!-- end list --><div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"ggtree"</span>, <span class="dt">version =</span> <span class="st">"3.8"</span>)</span></code></pre></div>
</div>
<div id="installing-pcmfit" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-pcmfit" class="anchor"></a>Installing PCMFit</h1>
<div id="from-github" class="section level2">
<h2 class="hasAnchor">
<a href="#from-github" class="anchor"></a>From Github</h2>
<p>Currently the package can be installed from github using the command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"venelin/PCMFit"</span>)</span></code></pre></div>
</div>
<div id="from-cran" class="section level2">
<h2 class="hasAnchor">
<a href="#from-cran" class="anchor"></a>From CRAN</h2>
<p>Publishing PCMFit on CRAN is planned after release of the first stable and documented version.</p>
</div>
</div>
<div id="parallel-execution" class="section level1">
<h1 class="hasAnchor">
<a href="#parallel-execution" class="anchor"></a>Parallel execution</h1>
<p>Currently PCMFit implements parallel execution for the inference of mixed Gaussian phylogenetic models with unknown shifts. This is optional but highly recommended. To enable parallel execution, it is necessary to run PCMFit on a computer equipped with a multiple core processor or on multiple node computing cluster. In its current implementation, PCMFit uses the function <code>%dopar%</code> from the R-package <a href="https://CRAN.R-project.org/package=foreach"><code>foreach</code></a> to parallelize the execution of (nested) <code>foreach</code> loops. This parallelization has been tested using two parallel backends for the <code>%dopar%</code> function:</p>
<ul>
<li>Using the R packages <a href="https://CRAN.R-project.org/package=doMPI"><code>doMPI</code></a> and <a href="https://CRAN.R-project.org/package=Rmpi"><code>Rmpi</code></a> on a multiple node cluster with <code>open_mpi/1.6.5</code> installed. In particular, MGPM inference has been run using up to 250 cores on the <a href="https://scicomp.ethz.ch/wiki/Euler">ETH scientific computing cluster Euler</a>.</li>
<li>Using the R package <a href="https://CRAN.R-project.org/package=doParallel"><code>doParallel</code></a> on a MacBook Pro (Retina, 15-inch, Late 2013), 2.3 GHz Intel Core i7 processor (4 physical cores, 8 logical cores), running macOS Sierra 10.12.6.</li>
</ul>
<p>To install the above packages, follow the most recent instructions in their documentation (links to the packages web-pages provided above). Once you have installed the parallel backend of choice, you can paste/edit the following code snippet in the beginning of the R-script for running PCMFit model inference:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PCMBase)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PCMBaseCpp)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(PCMFit)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># other needed packages, e.g. ape, data.table etc...</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># extract dataset identifier and possibly other parameters from the command line:</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>args &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/commandArgs.html">commandArgs</a></span>(<span class="dt">trailingOnly =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(args) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb7-9"><a href="#cb7-9"></a>  data_id &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(args[<span class="dv">1</span>])</span>
<span id="cb7-10"><a href="#cb7-10"></a>} <span class="cf">else</span> {</span>
<span id="cb7-11"><a href="#cb7-11"></a>  data_id &lt;-<span class="st"> </span>1L</span>
<span id="cb7-12"><a href="#cb7-12"></a>}</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co"># A character string used in filenames for a model inference on a given data:</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>prefixFiles =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MGPM_A_F_BC2_RR_DATAID_"</span>, data_id)</span>
<span id="cb7-16"><a href="#cb7-16"></a></span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># creating the cluster for this PCMFit run:</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/exists.html">exists</a></span>(<span class="st">"cluster"</span>) <span class="op">||</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(cluster)) {</span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="cf">if</span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(doMPI)) {</span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="co"># using MPI cluster as distributed node cluster (possibly running on a </span></span>
<span id="cb7-22"><a href="#cb7-22"></a>    <span class="co"># cluster of multiple nodes)</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="co"># Get the number of cores. Assume this is run in a batch job.</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>    p =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/strtoi.html">strtoi</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">'LSB_DJOB_NUMPROC'</span>))</span>
<span id="cb7-25"><a href="#cb7-25"></a>    cluster &lt;-<span class="st"> </span><span class="kw">startMPIcluster</span>(<span class="dt">count =</span> p<span class="dv">-1</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-26"><a href="#cb7-26"></a>    doMPI<span class="op">::</span><span class="kw">registerDoMPI</span>(cluster)</span>
<span id="cb7-27"><a href="#cb7-27"></a>  } <span class="cf">else</span> {</span>
<span id="cb7-28"><a href="#cb7-28"></a>    <span class="co"># possibly running on personal computer without mpi installation</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>    cluster &lt;-<span class="st"> </span>parallel<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span>(</span>
<span id="cb7-30"><a href="#cb7-30"></a>      parallel<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>(<span class="dt">logical =</span> <span class="ot">TRUE</span>),</span>
<span id="cb7-31"><a href="#cb7-31"></a>      <span class="dt">outfile =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"log_"</span>, prefixFiles, <span class="st">".txt"</span>))</span>
<span id="cb7-32"><a href="#cb7-32"></a>    doParallel<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span>(cluster)</span>
<span id="cb7-33"><a href="#cb7-33"></a>  }</span>
<span id="cb7-34"><a href="#cb7-34"></a>}</span></code></pre></div>
<p>Finally, to tell PCMFit that it should run the inference in parallel, specify the argument <code>doParallel=TRUE</code> in calls to the function <code>PCMFitMixed</code>. A full example for this is provided in the user guide <a href="https://venelin.github.io/PCMFit/articles/pcmfitmixed.html">Inferring an MGPM with Unknown Shifts</a>.</p>
</div>
<div id="resources" class="section level1">
<h1 class="hasAnchor">
<a href="#resources" class="anchor"></a>Resources</h1>
<p>A brief historical background and theoretical overview of PCMs can be found in Chapter 1 of (Mitov 2018a). A more general introduction can be found in (Harmon 2018). The research article “Automatic Generation of Evolutionary Hypotheses using Mixed Gaussian Phylogenetic Models” provides a general introduction to MGPMs and reports a real data example and a simulation based comparison of MGPMs versus other implementations of phylogenetic comparative models with shifts. The article is currently undergoing peer review for a publication.</p>
<p>The user guides and technical reference for the library are available on the <a href="https://venelin.github.io/PCMFit/">PCMFit web-page</a>:</p>
<p><strong>Note:</strong> <em>The writing of the user gudes and <a href="https://venelin.github.io/PCMFit/reference/index.html">help articles</a> for this package is in progress. Please, contact the author for assistance, in case you need to use PCMFit right away and need help with the coding examples. Thanks for your understanding.</em></p>
<ul>
<li>The <a href="https://venelin.github.io/PCMFit/articles/pcmfit.html">Getting started</a> guide introduces mixed Gaussian phylogenetic models (MGPMs) and provides an example how to use the function <code><a href="reference/PCMFit.html">PCMFit()</a></code> to infer such models on a given tree and trait data.</li>
<li>The <a href="https://venelin.github.io/PCMFit/articles/pcmfitmixed.html">Inferring an MGPM with Unknown Shifts</a> guide shows how to use the function <code><a href="reference/PCMFitMixed.html">PCMFitMixed()</a></code> to select the best MGPM for a given tree and trait data, based on an information loss function such as the Akaike information criterion (AIC) <em>(in preparation)</em>.</li>
<li>The <a href="https://venelin.github.io/PCMFit/articles/parambootstrap.html">Performing Parametric Bootstrap of an MGPM</a> guide shows how to simulate and perform MGPM inference on parametric bootstrap datasets in order to assess the uncertainty of a given MGPM <em>(in preparation)</em>.</li>
</ul>
<p>The PCMFit source code is located in the <a href="https://github.com/venelin/PCMFit">PCMFit github repository</a>.</p>
<p>Feature requests, bugs, etc can be reported in the <a href="https://github.com/venelin/PCMFit/issues">PCMFit issues list</a>.</p>
</div>
<div id="related-tools" class="section level1">
<h1 class="hasAnchor">
<a href="#related-tools" class="anchor"></a>Related tools</h1>
<p>PCMFit builds on top of a stack of three tools enabling fast likelihood calculation and simulation of MGPMs:</p>
<ul>
<li>The R-package <a href="https://venelin.github.io/PCMBase/">PCMBase</a> implements the specification, likelihood calculation and simulation of MGPMs (Mitov et al. 2018).</li>
<li>The auxiliary package <a href="https://github.com/venelin/PCMBaseCpp">PCMBaseCpp</a> provides a fast C++ implementation of the likelihood calculation as described in (Mitov et al. 2018).</li>
<li>PCMBaseCpp relies on the C++ library <a href="https://github.com/venelin/SPLITT">SPLITT</a> implementing fast traversal of phylogenetic trees (Mitov and Stadler 2018).</li>
</ul>
</div>
<div id="citing-pcmfit" class="section level1">
<h1 class="hasAnchor">
<a href="#citing-pcmfit" class="anchor"></a>Citing PCMFit</h1>
<p>To acknowledge the PCMFit package in a publication or other presentation, please cite:</p>
<p>Mitov, V., Bartoszek, K., &amp; Stadler, T. (2019). Automatic generation of evolutionary hypotheses using mixed Gaussian phylogenetic models. Proceedings of the National Academy of Sciences of the United States of America, <a href="http://doi.org/10.1073/pnas.1813823116" class="uri">http://doi.org/10.1073/pnas.1813823116</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">@</span>article{Mitov<span class="op">:</span>2019agh,</span>
<span id="cb8-2"><a href="#cb8-2"></a>title =<span class="st"> </span>{Automatic generation of evolutionary hypotheses using mixed Gaussian phylogenetic models},</span>
<span id="cb8-3"><a href="#cb8-3"></a>    author =<span class="st"> </span>{Venelin Mitov and Krzysztof Bartoszek and Tanja Stadler},</span>
<span id="cb8-4"><a href="#cb8-4"></a>    journal =<span class="st"> </span>{Proceedings of the National Academy of Sciences of the United States of America},</span>
<span id="cb8-5"><a href="#cb8-5"></a>    year =<span class="st"> </span>{<span class="dv">2019</span>},</span>
<span id="cb8-6"><a href="#cb8-6"></a>    url =<span class="st"> </span>{https<span class="op">:</span><span class="er">//</span>www.pnas.org<span class="op">/</span>lookup<span class="op">/</span>doi<span class="op">/</span><span class="fl">10.1073</span><span class="op">/</span>pnas<span class="fl">.1813823116</span>},</span>
<span id="cb8-7"><a href="#cb8-7"></a>}</span></code></pre></div>
</div>
<div id="used-software-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#used-software-packages" class="anchor"></a>Used software packages</h1>
<p>Although, I have been consistent in my effort to update the following list with any new package I have used in developing and testing PCMFit, chances are that I have omitted some of these tools. I apologise to their authors.</p>
<p>The PCMFit R-package uses the following 3rd party R-packages:</p>
<ul>
<li>For tree processing in R: ape v5.3 (Paradis et al. 2019), data.table v1.12.2 (Dowle and Srinivasan 2019), PCMBase v1.2.11 (Mitov 2019b);</li>
<li>For specification and manipulation of models in R: PCMBase v1.2.11 (Mitov 2019b), PCMBaseCpp v0.1.6 (Mitov 2019a), SPLITT v1.2.1 (Mitov 2018b);</li>
<li>For data processing in R: data.table v1.12.2 (Dowle and Srinivasan 2019);</li>
<li>For parallel execution: iterators v1.0.10 (Analytics and Weston 2018), foreach v1.4.7 (Revolution Analytics and Weston, n.d.), doParallel v1.0.15 (Corporation and Weston 2018);</li>
<li>For algebraic computation: expm v0.999.4 (Goulet et al. 2019), mvtnorm v1.0.11 (Genz et al. 2019);</li>
<li>For plotting: ggtree v1.15.3 (Yu and Lam 2019), ggplot2 v3.2.1 (Wickham et al. 2018), cowplot v1.0.0 (Wilke 2019);</li>
<li>For unit-testing: testthat v2.1.1 (Wickham 2018);</li>
<li>For documentation and web-site generation: roxygen2 v6.1.1 (Wickham, Danenberg, and Eugster 2018), pkgdown v1.3.0 (Wickham and Hesselberth 2018);</li>
</ul>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">

<div id="ref-R-iterators">

Analytics, Revolution, and Steve Weston. 2018. *Iterators: Provides
Iterator Construct for R*.
<https:>.

</https:>
</div>

<div id="ref-R-doParallel">

Corporation, Microsoft, and Steve Weston. 2018. *DoParallel: Foreach
Parallel Adaptor for the ’Parallel’ Package*.
<https:>.

</https:>
</div>

<div id="ref-R-data-table">

Dowle, Matt, and Arun Srinivasan. 2019. *Data.table: Extension of
‘Data.frame‘*. <https:>.

</https:>
</div>

<div id="ref-R-mvtnorm">

Genz, Alan, Frank Bretz, Tetsuhisa Miwa, Xuefei Mi, and Torsten Hothorn.
2019. *Mvtnorm: Multivariate Normal and T Distributions*.
<https:>.

</https:>
</div>

<div id="ref-R-expm">

Goulet, Vincent, Christophe Dutang, Martin Maechler, David Firth, Marina
Shapira, and Michael Stadelmann. 2019. *Expm: Matrix Exponential, Log,
’Etc’*. <https:>.

</https:>
</div>

<div id="ref-Harmon:2018pcm">

Harmon, Luke J. 2018. *Phylogenetic Comparative Methods*. Learning from
Trees. <https:></https:>.

</div>

<div id="ref-Mitov:2018hh">

Mitov, Venelin. 2018a. “Phylogenetic Comparative Methods in the Era of
Big Data.” PhD thesis, Zurich: ETH Zurich.
<https:>.

</https:>
</div>

<div id="ref-R-SPLITT">

———. 2018b. *SPLITT: A Generic Library for Serial and Parallel Lineage
Traversal of Trees*.

</div>

<div id="ref-R-PCMBaseCpp">

———. 2019a. *PCMBaseCpp: A C++ Implementation of Parallel Likelihood
Calculation for Phylogenetic Comparative Models*.

</div>

<div id="ref-R-PCMBase">

———. 2019b. *PCMBase: Simulation and Likelihood Calculation of
Phylogenetic Comparative Models*.
<https:>.

</https:>
</div>

<div id="ref-Mitov:2018fl">

Mitov, Venelin, Krzysztof Bartoszek, Georgios Asimomitis, and Tanja
Stadler. 2018. “Fast likelihood evaluation for multivariate phylogenetic
comparative methods: the PCMBase R package.” *arXiv.org*, September,
arXiv:1809.09014. <http:>.

</http:>
</div>

<div id="ref-Mitov:2019agh">

Mitov, Venelin, Krzysztof Bartoszek, and Tanja Stadler. 2019. “Automatic
Generation of Evolutionary Hypotheses Using Mixed Gaussian Phylogenetic
Models.” *Proceedings of the National Academy of Sciences of the United
States of America*.
<https:>.

</https:>
</div>

<div id="ref-Mitov:2018dqa">

Mitov, Venelin, and Tanja Stadler. 2018. “Parallel likelihood
calculation for phylogenetic comparative models: The SPLITT C++
library.” *Methods in Ecology and Evolution*, December,
2041–210X.13136.

</div>

<div id="ref-R-ape">

Paradis, Emmanuel, Simon Blomberg, Ben Bolker, Joseph Brown, Julien
Claude, Hoa Sien Cuong, Richard Desper, et al. 2019. *Ape: Analyses of
Phylogenetics and Evolution*. <https:>.

</https:>
</div>

<div id="ref-R-foreach">

Revolution Analytics, and Steve Weston. n.d. *Foreach: Provides Foreach
Looping Construct for R*.

</div>

<div id="ref-R-testthat">

Wickham, Hadley. 2018. *Testthat: Unit Testing for R*.
<https:>.

</https:>
</div>

<div id="ref-R-ggplot2">

Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen,
Kohske Takahashi, Claus Wilke, and Kara Woo. 2018. *Ggplot2: Create
Elegant Data Visualisations Using the Grammar of Graphics*.
<https:>.

</https:>
</div>

<div id="ref-R-roxygen2">

Wickham, Hadley, Peter Danenberg, and Manuel Eugster. 2018. *Roxygen2:
In-Line Documentation for R*.
<https:>.

</https:>
</div>

<div id="ref-R-pkgdown">

Wickham, Hadley, and Jay Hesselberth. 2018. *Pkgdown: Make Static Html
Documentation for a Package*.
<https:>.

</https:>
</div>

<div id="ref-R-cowplot">

Wilke, Claus O. 2019. *Cowplot: Streamlined Plot Theme and Plot
Annotations for ’Ggplot2’*.
<https:>.

</https:>
</div>

<div id="ref-R-ggtree">

Yu, Guangchuang, and Tommy Tsan-Yuk Lam. 2019. *Ggtree: An R Package for
Visualization and Annotation of Phylogenetic Trees with Their Covariates
and Other Associated Data*.
<https:>.

</https:>
</div>

</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/venelin/PCMFit">https://​github.com/​venelin/​PCMFit</a>
</li>
<li>Report a bug at <br><a href="https://github.com/venelin/PCMFit/issues">https://​github.com/​venelin/​PCMFit/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3.0)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing PCMFit</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Venelin Mitov <br><small class="roles"> Author, maintainer, copyright holder </small>  <br><small>(<a href="https://venelin.github.io">venelin.github.io</a>)</small>
</li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/venelin/PCMFit"><img src="https://travis-ci.com/venelin/PCMFit.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Venelin Mitov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
